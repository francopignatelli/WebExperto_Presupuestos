<%= form_with(model: budget) do |form| %>
  <% if budget.errors.any? %>
    <div style="color: red">
      <h2><%= pluralize(budget.errors.count, "error") %> prohibited this budget from being saved:</h2>

      <ul>
        <% budget.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="budget-container">
    <%= form.text_field :name %>
    <%= form.text_area :description %>
  </div>
  <div class="budgets">
    <% if @budget.id != nil %>
      <%= link_to "Add Product", new_budget_lineitem_path(@budget), class: "btn btn-primary mb-3" %>
    <% end %>

    <div id="lineitems">
      <% if @budget.lineitems.length == 0 %>
        <p>No products added yet.</p>
      <% else %>
        <% @budget.lineitems.each do |lineitem| %>
            <%= render lineitem %>
          <p>
            <%= link_to "Show this product", lineitem %>
          </p>
          <hr>
        <% end %>  
      <% end %>  
    </div>
    <p class="total-price">
      TOTAL:
      <%= number_to_currency(@total_price, unit: '$', precision: 2, delimiter: '.', separator: ',') %>
    </p>
    <div class="budget-buttons">
      <button class="quit-budget">Eliminar presupuesto</button>
      <%= form.submit %>
    </div>
  </div>
<% end %>
