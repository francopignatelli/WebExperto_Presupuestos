<%= form_with(model: budget) do |form| %>
  <% if budget.errors.any? %>
    <div style="color: red">
      <h2><%= pluralize(budget.errors.count, "error") %> Evitó que este presupuesto no pueda ser guardado...</h2>
      <ul>
        <% budget.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>
  <div class="bud-bud-container">
    <div class="budget-container">
      <%= form.label :name, 'Nombre de presupuesto' %>
      <%= form.text_field :name, placeholder: 'Nombre de presupuesto', class:"bud-form-name" %>
      <%= form.label :name, 'Descripción' %>
      <%= form.text_area :description, placeholder: 'Descripción del presupuesto',class:"bud-form-desc" %>
    </div>
  </div>
  <div class="budgets">
    <% if @budget.id != nil %>
      <%= link_to "Agregar producto", new_budget_lineitem_path(@budget), class: "add-product" %>
    <% end %>

    <div id="lineitems">
      <% if @budget.lineitems.length == 0 %>
        <p>Sin productos.</p>
      <% else %>
        <% @budget.lineitems.each do |lineitem| %>
            <%= render lineitem %>
        <% end %>  
        <p class="total-price">
          TOTAL: <%= number_to_currency(@total_price, unit: '$', precision: 2, delimiter: ',', separator: '.') %>
        </p>
      <% end %>  
    </div>
  </div>
  <div class="budget-buttons">
    <%= form.submit "Guardar presupuesto", class: "create-budget" %>
		<%= link_to "Volver", budgets_path, class: "back-budget" %>
  </div>
<% end %>
